ylab(paste("Axe 2 :",round(resultat_ACP$eig[2,2],0),"%"))
ggplot(data=dbind,aes(x=Dim.1,y=Dim.2))+
ggtitle("Titre")+
geom_point(aes(color=groupe))+
geom_text_repel(aes(color=groupe,label=c_abrv),
size=3, max.overlaps = 20, max.iter = 1000)+
geom_hline(yintercept=0,linetype="dashed")+
geom_vline(xintercept = 0,linetype="dashed")+
theme(plot.title=element_text(hjust=0.5),
panel.background =element_rect(fill="white"))+
xlab(paste("Axe 1 :",round(resultat_ACP$eig[1,2],0),"%"))+
ylab(paste("Axe 2 :",round(resultat_ACP$eig[2,2],0),"%"))+
guides(color = F)
ggplot(data=dbind,aes(x=Dim.1,y=Dim.2))+
ggtitle("Titre")+
geom_point(aes(color=groupe))+
geom_text_repel(aes(color=groupe,label=c_abrv),
size=3, max.overlaps = 20, max.iter = 1000)+
geom_hline(yintercept=0,linetype="dashed")+
geom_vline(xintercept = 0,linetype="dashed")+
theme(plot.title=element_text(hjust=0.5),
panel.background =element_rect(fill="white"))+
xlab(paste("Axe 1 :",round(resultat_ACP$eig[1,2],0),"%"))+
ylab(paste("Axe 2 :",round(resultat_ACP$eig[2,2],0),"%"))+
guides(color = F)
ggplot(data = carte_europe) +
geom_sf(aes(fill = groupe)) +
guides(fill = F) +
ggtitle("Figure VI - Carte des pays classifiés selon les opinions agrégées sur l'environnement") +
coord_sf(datum = NA)
summary(reg1)
residuals(reg1)
predict(reg1)
base_simple_propre
view(base_simple_propre)
reg3 <- lm(data = base_simple_propre, formula = PC_GDP_2016 ~ env1 + env6 + happy + MOI_EUR_2016)
summary(reg3)
residuals(reg1)
predict(reg1)
summary(reg3)
reg3 <- lm(data = base_simple_propre, formula = PC_GDP_2016 ~ env1 + env6 + happy + MOI_EUR_2016)
# comparaison de modèles :
anova(reg1,reg3)
# comparaison de modèles :
anova(reg1,reg2)
anova(reg1)
reg4 <- lm(data = base_simple_propre, formula = PC_GDP_2016 ~ env1 + + env2 + env3 + env4 + env5 + env6 + happy + MOI_EUR_2016)
summary(reg4)
residuals(reg1)
ggplot(data = base_simple_propre, mapping = aes(x = env5, y = PC_GDP_2016)) +
theme_bw() +
geom_jitter()+
geom_smooth(method = lm) + # j'viens de découvrir : pour une droite linéaire, faut mettre method = lm, sinon, loess est pas mal
labs(x = "Sensibilité moyenne à l'écologie (env1)", y = "Dépenses environnementales en part de PIB") +
theme(legend.position = "bottom") +
scale_color_manual(name = "Les dépenses pour l'environnement sont-elles sensibles à l'opinion publique ?", values =
c("black","gray"))+
guides(color = guide_legend(ncol=2, direction = "horizontal"))
library(tidyverse)
library(ggforce)
library(sf)
library(haven)
library(FactoMineR)
library(ggrepel)
library(readxl)
library(stargazer)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx")
EVS <- read_dta("ZA7500_v4-0-0.dta")
EVS <- read_dta("ZA7500_v4-0-0.dta")
dep <-read_xlsx("depenses-env.xlsx")
view(coef_gini)
? read_xlsx
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3)
view(coef_gini)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 5)
view(coef_gini)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 7)
view(coef_gini)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 7)
view(coef_gini)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 7) %>%
select(TIME, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 7) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
view(coef_gini)
educ_sup <- read.xlsx("education_sup_UE.xlsx")
educ_sup <- read_xlsx("education_sup_UE.xlsx")
educ_sup
view(educ_sup)
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11)
view(educ_sup)
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
view(educ_sup)
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
view(educ_sup)
rev_median <- read_xls("revenu_median_UE.xls")
view(rev_median)
rev_med <- read_xls("revenu_median_UE.xls")
rev_med <- read_xls("revenu_median_UE.xls", skip = 10)
view(rev_med)
rev_med <- read_xls("revenu_median_UE.xls", skip = 10)
view(rev_med)
db <-EVS %>%
select(caseno, year, country, c_abrv, v7, v199, v200, v201, v202, v203, v204) %>%
mutate(happy = as.numeric(case_when(v7 %in% c("1", "2") ~ "1",
v7 %in% c("3", "4") ~ "0",
v7 %in% c("8", "9") ~ "NA")),
env1 = as.numeric(case_when(v199 %in% c("1","2") ~ "1",
v199 %in% c("3", "4", "5") ~ "0",
v199 %in% c("8", "9") ~ "NA")),
env2 = as.numeric(case_when(v200 %in% c("1","2") ~ "1",
v200 %in% c("3", "4", "5") ~"0",
v200 %in% c("8", "9") ~ "NA")),
env3 = as.numeric(case_when(v201 %in% c("1","2") ~ "1",
v201 %in% c("3", "4", "5") ~"0",
v201 %in% c("8", "9") ~ "NA")),
env4 = as.numeric(case_when(v202 %in% c("1","2") ~ "1",
v202 %in% c("3", "4", "5") ~"0",
v202 %in% c("8", "9") ~ "NA")),
env5 = as.numeric(case_when(v203 %in% c("1","2") ~ "1",
v203 %in% c("3", "4", "5") ~"0",
v203 %in% c("8", "9") ~ "NA")),
env6 = as.numeric(case_when(v204 %in% c("1") ~ "1",
v204 %in% c("2") ~"0",
v204 %in% c("8", "9") ~ "NA")))%>%
group_by(country, c_abrv) %>%
summarize(
#effectif = n_distinct(caseno),
happy = mean(happy == 1, na.rm = T),
env1 = mean(env1 == 1, na.rm = T),
env2 = mean(env2 == 1, na.rm = T),
env3 = mean(env3 == 1, na.rm = T),
env4 = mean(env4 == 1, na.rm = T),
env5 = mean(env5 == 1, na.rm = T),
env6 = mean(env6 == 1, na.rm = T))
db$Pays <- db$c_abrv
base_simple <- db %>%
full_join(dep, by = "Pays")
base_simple_propre <- base_simple %>%
filter(Pays != "NA", happy != "NA")
base_simple_propre <- base_simple_propre %>%
select(c_abrv, happy, env1, env2, env3, env4, env5, env6, MOI_EUR_2016, PC_GDP_2016)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 7) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
rev_med <- read_xls("revenu_median_UE.xls", skip = 10)
library(tidyverse)
library(ggforce)
library(sf)
library(haven)
library(FactoMineR)
library(ggrepel)
library(readxl)
library(stargazer)
setwd("~/Documents/ENS/econometrie/projet_r")
EVS <- read_dta("ZA7500_v4-0-0.dta")
EVS <- read_dta("ZA7500_v4-0-0.dta")
dep <-read_xlsx("depenses-env.xlsx")
db <-EVS %>%
select(caseno, year, country, c_abrv, v7, v199, v200, v201, v202, v203, v204) %>%
mutate(happy = as.numeric(case_when(v7 %in% c("1", "2") ~ "1",
v7 %in% c("3", "4") ~ "0",
v7 %in% c("8", "9") ~ "NA")),
env1 = as.numeric(case_when(v199 %in% c("1","2") ~ "1",
v199 %in% c("3", "4", "5") ~ "0",
v199 %in% c("8", "9") ~ "NA")),
env2 = as.numeric(case_when(v200 %in% c("1","2") ~ "1",
v200 %in% c("3", "4", "5") ~"0",
v200 %in% c("8", "9") ~ "NA")),
env3 = as.numeric(case_when(v201 %in% c("1","2") ~ "1",
v201 %in% c("3", "4", "5") ~"0",
v201 %in% c("8", "9") ~ "NA")),
env4 = as.numeric(case_when(v202 %in% c("1","2") ~ "1",
v202 %in% c("3", "4", "5") ~"0",
v202 %in% c("8", "9") ~ "NA")),
env5 = as.numeric(case_when(v203 %in% c("1","2") ~ "1",
v203 %in% c("3", "4", "5") ~"0",
v203 %in% c("8", "9") ~ "NA")),
env6 = as.numeric(case_when(v204 %in% c("1") ~ "1",
v204 %in% c("2") ~"0",
v204 %in% c("8", "9") ~ "NA")))%>%
group_by(country, c_abrv) %>%
summarize(
#effectif = n_distinct(caseno),
happy = mean(happy == 1, na.rm = T),
env1 = mean(env1 == 1, na.rm = T),
env2 = mean(env2 == 1, na.rm = T),
env3 = mean(env3 == 1, na.rm = T),
env4 = mean(env4 == 1, na.rm = T),
env5 = mean(env5 == 1, na.rm = T),
env6 = mean(env6 == 1, na.rm = T))
db$Pays <- db$c_abrv
base_simple <- db %>%
full_join(dep, by = "Pays")
base_simple_propre <- base_simple %>%
filter(Pays != "NA", happy != "NA")
base_simple_propre <- base_simple_propre %>%
select(c_abrv, happy, env1, env2, env3, env4, env5, env6, MOI_EUR_2016, PC_GDP_2016)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 7) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
rev_med <- read_xls("revenu_median_UE.xls", skip = 10)
epi2020results <- read.csv("epi2020results.csv")
eai_data <- read_excel("EAI-data.xlsx")
eai_data <- eai_data %>%
filter(EAI != "NA")
View(base_simple_propre)
View(coef_gini)
library(tidyverse)
library(ggforce)
library(sf)
library(haven)
library(FactoMineR)
library(ggrepel)
library(readxl)
library(stargazer)
## Données -----
# setwd("C:/Users/quent/Desktop/ENS Paris-Saclay/1A/1S2/Econométrie/TDs/Bases de données/Documents")
setwd("~/Documents/ENS/econometrie/projet_r")
EVS <- read_dta("ZA7500_v4-0-0.dta")
dep <-read_xlsx("depenses-env.xlsx")
db <-EVS %>%
select(caseno, year, country, c_abrv, v7, v199, v200, v201, v202, v203, v204) %>%
mutate(env1 = as.numeric(case_when(v199 %in% c("4","5") ~ "0",
v199 %in% c("1", "2", "3") ~ "1",
v199 %in% c("8", "9") ~ "NA")),
env2 = as.numeric(case_when(v200 %in% c("1","2") ~ "0",
v200 %in% c("3", "4", "5") ~"1",
v200 %in% c("8", "9") ~ "NA")),
env3 = as.numeric(case_when(v201 %in% c("1","2") ~ "0",
v201 %in% c("3", "4", "5") ~"1",
v201 %in% c("8", "9") ~ "NA")),
env4 = as.numeric(case_when(v202 %in% c("1","2") ~ "0",
v202 %in% c("3", "4", "5") ~"1",
v202 %in% c("8", "9") ~ "NA")),
env5 = as.numeric(case_when(v203 %in% c("1","2") ~ "0",
v203 %in% c("3", "4", "5") ~"1",
v203 %in% c("8", "9") ~ "NA")),
env6 = as.numeric(case_when(v204 %in% c("1") ~ "1",
v204 %in% c("2") ~"0",
v204 %in% c("8", "9") ~ "NA")))%>%
group_by(country, c_abrv) %>%
summarize(
effectif = n_distinct(caseno),
perc_env = 100*mean(mean(env1 == 1, na.rm = T), mean(env2 == 1, na.rm = T), mean(env3 == 1, na.rm = T), env4 = 100*mean(env4 == 1, na.rm = T), env5 = 100*mean(env5 == 1, na.rm = T)),
soutien_pol_env = 100*mean(env6 == 1, na.rm = T))
names(db)[names(db)=="c_abrv"] <- "Pays"
names(db)[names(db)=="country"] <- "code"
base_simple <- db %>%
full_join(dep, by = "Pays")
base_simple_propre <- base_simple %>%
filter(Pays != "NA")
base_simple_propre <- base_simple_propre %>%
select(Pays, env1, env2, env3, env4, env5, env6, MOI_EUR_2016, PC_GDP_2016)
base_simple_propre <- base_simple %>%
filter(Pays != "NA")
base_simple_propre <- base_simple_propre %>%
select(Pays, env1, env2, env3, env4, env5, env6, MOI_EUR_2016, PC_GDP_2016)
coef_gini <- read_xlsx("coefficient_gini_UE.xlsx", sheet = 3, skip = 7) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
rev_med <- read_xls("revenu_median_UE.xls", skip = 10)
epi2020results <- read.csv("epi2020results.csv")
eai_data <- read_excel("EAI-data.xlsx")
eai_data <- eai_data %>%
filter(EAI != "NA")
code_pays <- read_csv("all.csv")
sensi_data <- db %>%
full_join(eai_data, by = "code") %>%
filter(EAI != "NA", env1 != "env1") %>%
summarize(code = first(code),
Pays = first(Pays),
sensi_env = )
#setwd("C:/Users/quent/Desktop/ENS Paris-Saclay/1A/1S2/Econométrie/TDs/Bases de données/Documents")
setwd("~/Documents/ENS/econometrie/projet_r")
setwd("~/Documents/ENS/econometrie/projet_r")
EVS <- read_dta("ZA7500_v4-0-0.dta")
depenses <-read_xlsx("depenses-env.xlsx")
EVS_env <-EVS %>%
select(caseno, year, country, c_abrv, v7, v199, v200, v201, v202, v203, v204) %>%
mutate(env1 = as.numeric(case_when(v199 %in% c("4","5") ~ "0",
v199 %in% c("1", "2", "3") ~ "1",
v199 %in% c("8", "9") ~ "NA")),
env2 = as.numeric(case_when(v200 %in% c("1","2") ~ "0",
v200 %in% c("3", "4", "5") ~"1",
v200 %in% c("8", "9") ~ "NA")),
env3 = as.numeric(case_when(v201 %in% c("1","2") ~ "0",
v201 %in% c("3", "4", "5") ~"1",
v201 %in% c("8", "9") ~ "NA")),
env4 = as.numeric(case_when(v202 %in% c("1","2") ~ "0",
v202 %in% c("3", "4", "5") ~"1",
v202 %in% c("8", "9") ~ "NA")),
env5 = as.numeric(case_when(v203 %in% c("1","2") ~ "0",
v203 %in% c("3", "4", "5") ~"1",
v203 %in% c("8", "9") ~ "NA")),
env6 = as.numeric(case_when(v204 %in% c("1") ~ "1",
v204 %in% c("2") ~"0",
v204 %in% c("8", "9") ~ "NA")))%>%
group_by(country, c_abrv) %>%
summarize(
effectif = n_distinct(caseno),
perc_env = 100*mean(mean(env1 == 1, na.rm = T), mean(env2 == 1, na.rm = T), mean(env3 == 1, na.rm = T), env4 = 100*mean(env4 == 1, na.rm = T), env5 = 100*mean(env5 == 1, na.rm = T)),
soutien_pol_env = 100*mean(env6 == 1, na.rm = T))
names(EVS_env)[names(EVS_env)=="c_abrv"] <- "Pays"
names(EVS_env)[names(EVS_env)=="country"] <- "code"
EVS_et_depenses <- EVS_env %>%
full_join(depenses, by = "Pays")%>%
filter(Pays != "NA") %>%
select(Pays, perc_env, soutien_pol_env, MOI_EUR_2016, PC_GDP_2016)
eai_data <- read_excel("EAI-data.xlsx")
eai_data <- eai_data %>%
filter(EAI != "NA")
code_pays <- read_csv("all.csv")
env_et_depenses <- EVS_et_depenses %>%
full_join(eai_data, by = "code") %>%
left_join(code_pays, by = c("Pays" = "alpha-2")) %>%
filter(EAI != "NA", perc_env != "NA", PC_GDP_2016 != "NA") %>%
group_by(Pays) %>%
summarize(Nom_pays = first(name),
code = first(code),
Pays = first(Pays),
sensi_env = (perc_env + soutien_pol_env + EAI)/3,
perc_env = first(perc_env),
soutien_pol_env = first(soutien_pol_env),
conn_env = first(EAI),
depenses_brutes_env = first(MOI_EUR_2016),
part_depenses_env = first(PC_GDP_2016))
gini <- read_excel("GINI_2017.xlsx")
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
rev_med <- read_xls("revenu_median_UE.xls", skip = 10)
epi2020results <- read.csv("epi2020results.csv")
knitr::opts_chunk$set(echo = TRUE)
summary(env_et_depenses)
stargazer(env_et_depenses)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
## Packages ----
library(tidyverse)
library(ggforce)
library(sf)
library(haven)
library(FactoMineR)
library(ggrepel)
library(readxl)
library(stargazer)
## Données -----
#setwd("C:/Users/quent/Desktop/ENS Paris-Saclay/1A/1S2/Econométrie/TDs/Bases de données/Documents")
setwd("~/Documents/ENS/econometrie/projet_r")
EVS <- read_dta("ZA7500_v4-0-0.dta")
depenses <-read_xlsx("depenses-env.xlsx")
EVS_env <-EVS %>%
select(caseno, year, country, c_abrv, v7, v199, v200, v201, v202, v203, v204) %>%
mutate(env1 = as.numeric(case_when(v199 %in% c("4","5") ~ "0",
v199 %in% c("1", "2", "3") ~ "1",
v199 %in% c("8", "9") ~ "NA")),
env2 = as.numeric(case_when(v200 %in% c("1","2") ~ "0",
v200 %in% c("3", "4", "5") ~"1",
v200 %in% c("8", "9") ~ "NA")),
env3 = as.numeric(case_when(v201 %in% c("1","2") ~ "0",
v201 %in% c("3", "4", "5") ~"1",
v201 %in% c("8", "9") ~ "NA")),
env4 = as.numeric(case_when(v202 %in% c("1","2") ~ "0",
v202 %in% c("3", "4", "5") ~"1",
v202 %in% c("8", "9") ~ "NA")),
env5 = as.numeric(case_when(v203 %in% c("1","2") ~ "0",
v203 %in% c("3", "4", "5") ~"1",
v203 %in% c("8", "9") ~ "NA")),
env6 = as.numeric(case_when(v204 %in% c("1") ~ "1",
v204 %in% c("2") ~"0",
v204 %in% c("8", "9") ~ "NA")))%>%
group_by(country, c_abrv) %>%
summarize(
effectif = n_distinct(caseno),
perc_env = 100*mean(mean(env1 == 1, na.rm = T), mean(env2 == 1, na.rm = T), mean(env3 == 1, na.rm = T), env4 = 100*mean(env4 == 1, na.rm = T), env5 = 100*mean(env5 == 1, na.rm = T)),
soutien_pol_env = 100*mean(env6 == 1, na.rm = T))
names(EVS_env)[names(EVS_env)=="c_abrv"] <- "Pays"
names(EVS_env)[names(EVS_env)=="country"] <- "code"
EVS_et_depenses <- EVS_env %>%
full_join(depenses, by = "Pays")%>%
filter(Pays != "NA") %>%
select(Pays, perc_env, soutien_pol_env, MOI_EUR_2016, PC_GDP_2016)
eai_data <- read_excel("EAI-data.xlsx")
eai_data <- eai_data %>%
filter(EAI != "NA")
code_pays <- read_csv("all.csv")
env_et_depenses <- EVS_et_depenses %>%
full_join(eai_data, by = "code") %>%
left_join(code_pays, by = c("Pays" = "alpha-2")) %>%
filter(EAI != "NA", perc_env != "NA", PC_GDP_2016 != "NA") %>%
group_by(Pays) %>%
summarize(Nom_pays = first(name),
code = first(code),
Pays = first(Pays),
sensi_env = (perc_env + soutien_pol_env + EAI)/3,
perc_env = first(perc_env),
soutien_pol_env = first(soutien_pol_env),
conn_env = first(EAI),
depenses_brutes_env = first(MOI_EUR_2016),
part_depenses_env = first(PC_GDP_2016))
gini <- read_excel("GINI_2017.xlsx")
educ_sup <- read_xlsx("education_sup_UE.xlsx", sheet = 3, skip = 11) %>%
select(TIME, "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019")
rev_med <- read_xls("revenu_median_UE.xls", skip = 10)
epi2020results <- read.csv("epi2020results.csv")
#regexec() grep()
summary(env_et_depenses)
env_et_depenses <- as.data.frame(env_et_depenses)
view(env_eet_depenses)
view(env_et_depenses)
?select()
env_et_depenses %>%
select("Pays", "Nom_pays", "sensi_env", "perc_env", "soutien_pol_env", "conn_env", "depenses_brutes_env", "part_depenses_env") %>%
stargazer(env_et_depenses), type = 'html')
env_et_depenses2 <- env_et_depenses2 %>%
select("Pays", "Nom_pays", "sensi_env", "perc_env", "soutien_pol_env", "conn_env", "depenses_brutes_env", "part_depenses_env") %>%
stargazer(env_et_depenses2), type = 'html')
env_et_depenses2 <- env_et_depenses2 %>%
select("Pays", "Nom_pays", "sensi_env", "perc_env", "soutien_pol_env", "conn_env", "depenses_brutes_env", "part_depenses_env")
env_et_depenses2 <- env_et_depenses %>%
select("Pays", "Nom_pays", "sensi_env", "perc_env", "soutien_pol_env", "conn_env", "depenses_brutes_env", "part_depenses_env")
setwd("~/Documents/ENS/econometrie/projet_r")
library(tidyverse)
library(ggforce)
library(sf)
library(haven)
library(FactoMineR)
library(ggrepel)
library(readxl)
library(stargazer)
EVS <- read_dta("ZA7500_v4-0-0.dta")
depenses <-read_xlsx("depenses-env.xlsx")
EVS_env <-EVS %>%
select(caseno, year, country, c_abrv, v7, v199, v200, v201, v202, v203, v204) %>%
mutate(env1 = as.numeric(case_when(v199 %in% c("4","5") ~ "0",
v199 %in% c("1", "2", "3") ~ "1",
v199 %in% c("8", "9") ~ "NA")),
env2 = as.numeric(case_when(v200 %in% c("1","2") ~ "0",
v200 %in% c("3", "4", "5") ~"1",
v200 %in% c("8", "9") ~ "NA")),
env3 = as.numeric(case_when(v201 %in% c("1","2") ~ "0",
v201 %in% c("3", "4", "5") ~"1",
v201 %in% c("8", "9") ~ "NA")),
env4 = as.numeric(case_when(v202 %in% c("1","2") ~ "0",
v202 %in% c("3", "4", "5") ~"1",
v202 %in% c("8", "9") ~ "NA")),
env5 = as.numeric(case_when(v203 %in% c("1","2") ~ "0",
v203 %in% c("3", "4", "5") ~"1",
v203 %in% c("8", "9") ~ "NA")),
env6 = as.numeric(case_when(v204 %in% c("1") ~ "1",
v204 %in% c("2") ~"0",
v204 %in% c("8", "9") ~ "NA")))%>%
group_by(country, c_abrv) %>%
summarize(
effectif = n_distinct(caseno),
perc_env = 100*mean(mean(env1 == 1, na.rm = T), mean(env2 == 1, na.rm = T), mean(env3 == 1, na.rm = T), env4 = 100*mean(env4 == 1, na.rm = T), env5 = 100*mean(env5 == 1, na.rm = T)),
soutien_pol_env = 100*mean(env6 == 1, na.rm = T))
names(EVS_env)[names(EVS_env)=="c_abrv"] <- "Pays"
names(EVS_env)[names(EVS_env)=="country"] <- "code"
EVS_et_depenses <- EVS_env %>%
full_join(depenses, by = "Pays")%>%
filter(Pays != "NA") %>%
select(Pays, perc_env, soutien_pol_env, MOI_EUR_2016, PC_GDP_2016)
eai_data <- read_excel("EAI-data.xlsx") %>%
filter(EAI != "NA")
code_pays <- read_csv("all.csv")
env_et_depenses <- EVS_et_depenses %>%
full_join(eai_data, by = "code") %>%
full_join(code_pays, by = c("Pays" = "alpha-2")) %>%
filter(EAI != "NA", perc_env != "NA", PC_GDP_2016 != "NA") %>%
group_by(Pays) %>%
summarize(Nom_pays = first(name),
code2 = first(code),
code = first(`alpha-3`),
Pays = first(Pays),
sensi_env = (perc_env + soutien_pol_env + EAI)/3,
perc_env = first(perc_env),
soutien_pol_env = first(soutien_pol_env),
conn_env = first(EAI),
depenses_brutes_env = first(MOI_EUR_2016),
part_depenses_env = first(PC_GDP_2016))
gini <- read_excel("GINI_2017.xlsx")
epi2020results <- read.csv("epi2020results.csv") %>%
select(code, EPI.new)
gini_et_plus <- env_et_depenses %>%
left_join(gini, by = "code") %>%
select(-Country)
gini_epi_plus <- gini_et_plus %>%
left_join(epi2020results, by = c("code2" = "code"))
reg1 <- lm(data = gini_epi_plus, formula = part_depenses_env ~ sensi_env) # je sais pas quoi faire avec ça, mais à approfondir
reg2 <- lm(data = gini_epi_plus, formula = part_depenses_env ~ soutien_pol_env) # je sais pas quoi faire avec ça, mais à approfondir
# comparaison de modèles :
anova(reg1,reg2)
anova(reg1)
reg3 <- lm(data = gini_epi_plus, formula = part_depenses_env ~ sensi_env + GINI_2017 + EPI.new)
# summary(reg4)
summary(reg3)
residuals(reg1)
predict(reg1)
ggplot(data = gini_epi_plus, mapping = aes(x = sensi_env, y = part_depenses_env)) +
theme_bw() +
geom_jitter()+
geom_smooth(method = lm) + # j'viens de découvrir : pour une droite linéaire, faut mettre method = lm, sinon, loess est pas mal
labs(x = "Sensibilité moyenne à l'écologie (sensi_env)", y = "Dépenses environnementales en part de PIB") +
theme(legend.position = "bottom") +
scale_color_manual(name = "Les dépenses pour l'environnement sont-elles sensibles à l'opinion publique ?", values =
c("black","gray"))+
guides(color = guide_legend(ncol=2, direction = "horizontal"))
