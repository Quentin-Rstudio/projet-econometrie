---
title: "code_stats"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

## Packages ----

library(tidyverse)
library(ggforce)
library(sf)
library(haven)
library(FactoMineR)
library(ggrepel)
library(readxl)
library(stargazer)
library(questionr)

## Données -----

#setwd("C:/Users/quent/Desktop/ENS Paris-Saclay/1A/1S2/Econométrie/TDs/Bases de données/Documents")
setwd("~/Documents/ENS/econometrie/projet_r")

base_complete <- read.csv("base_complete.csv") %>%
 select(-X)

base_exploration <- base_complete %>%
  select(-code2)
```

### Analyse univariée 

Nous procédons à une première analyse des variables présentes dans notre jeu de données. Pour ce faire, il s'agit de dresser un tableau des principaux indicateurs présents  :

```` {r, results = "asis" }

stargazer(base_exploration, type = 'html', title = "Principaux indicateurs des variables" )

````

### Analyse bivariée et analyse en composantes principales

Il s'agit désormais d'étudier les liens entre nos différentes variables explicatives.

```` {r}

graph1 <- ggplot(base_exploration, mapping = aes(x=sensi_env, y = perc_env)) + geom_point()

graph2 <- ggplot(base_exploration) + geom_label(aes (x = sensi_env, y = perc_env, label = Nom_pays), color = "darkgreen", size = 3, alpha = 0.3)


```

En raison du grand nombre de variables, nous n'effectuons pas une analyse bivariée entre la variable "qualité" et toutes les autres variables. il s'agit simplement d'explorer les données pour les principales variables que nous identifions ex ante comme importantes en raison des connaissances scientifiques sur le sujet. Par exemple, il est communément admis que les sulfates et le dioxide de soufre sont en partie responsables de maux de tête liés à une consommation non modérée de vin. 

On étudie alors les moyennes et écart-type par niveau de qualité de vins de certaines variables que nous avons identifiées comme primordiales. 

```` {r}


```
Ces indicateurs nous permettent de dégager certaines tendances et d'invalider certaines hypothèses préalables. Par exemple, alors que nous avions imaginé que la densité d'un vin pouvait jouer un rôle prépondérant dans la qualité d'un vin, les moyennes et écart-type de la densité des vins sont assez proches d'une variable à l'autre. La moyenne des sulfates présents dans les vins augmente elle de façon linéaire avec la qualité du vin, contrairement à nos idées pré-conçues, avec des écarts-types sensiblement proches. 

La représentation graphique facilite l'interprétation de ces indicateurs :

```{r}

graph3 <- ggplot(base_exploration, aes (x = perc_env, y = sensi_env)) + 
  geom_point(color = "darkgreen", size = 3, alpha = 0.3) +
  geom_smooth (method = "lm", size = 1, lty = 1, se = 2  )

#ggplot(data) + geom_smooth(aes (x = sulphates, y = quality), color = "darkgreen") 

````